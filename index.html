<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examples</title>
</head>

<body>
    <fieldset>
        <legend>Calculator</legend>
        <table>
            <tbody>
                <tr>
                    <td colspan="2">
                        <label for="n1">Number 1:</label>
                        <input type="number" id="n1" value="0" />
                    </td>
                    <td colspan="2">
                        <label for="n2">Number 2:</label>
                        <input type="number" id="n2" value="0" />
                    </td>
                </tr>
                <tr>
                    <th><button id="calc_b1" style="width: 50%;">+</button></th>
                    <th><button id="calc_b2" style="width: 50%;">-</button></th>
                    <th><button id="calc_b3" style="width: 50%;">/</button></th>
                    <th><button id="calc_b4" style="width: 50%;">*</button></th>
                </tr>
            </tbody>
        </table>

        <script>
            WebAssembly.instantiateStreaming(fetch("/dist/calculations.wasm"))
                .then(i => i.instance.exports)
                .then(({ add_z, add_r, mul_z, mul_r, div_z, div_r, sub_z, sub_r }) => {
                    document.querySelector("#calc_b1").addEventListener("click", () => {
                        let n1 = Number(document.querySelector("#n1").value)
                        let n2 = Number(document.querySelector("#n2").value)

                        if (!Number.isInteger(n1) || !Number.isInteger(n2)) {
                            alert(add_r(n1, n2))
                        } else {
                            alert(add_z(n1, n2))
                        }
                    })

                    document.querySelector("#calc_b2").addEventListener("click", () => {
                        let n1 = Number(document.querySelector("#n1").value)
                        let n2 = Number(document.querySelector("#n2").value)

                        if (!Number.isInteger(n1) || !Number.isInteger(n2)) {
                            alert(sub_r(n1, n2))
                        } else {
                            alert(sub_z(n1, n2))
                        }
                    })

                    document.querySelector("#calc_b3").addEventListener("click", () => {
                        let n1 = Number(document.querySelector("#n1").value)
                        let n2 = Number(document.querySelector("#n2").value)

                        if (!Number.isInteger(n1) || !Number.isInteger(n2)) {
                            alert(div_r(n1, n2))
                        } else {
                            alert(div_z(n1, n2))
                        }
                    })

                    document.querySelector("#calc_b4").addEventListener("click", () => {
                        let n1 = Number(document.querySelector("#n1").value)
                        let n2 = Number(document.querySelector("#n2").value)

                        if (!Number.isInteger(n1) || !Number.isInteger(n2)) {
                            alert(mul_r(n1, n2))
                        } else {
                            alert(mul_z(n1, n2))
                        }
                    })

                })
        </script>
    </fieldset>

    <fieldset>
        <legend>Greeter</legend>
        <script>

            WebAssembly.compileStreaming(fetch("/dist/greeter.wasm")).then(i => console.log(i)).then(i => {
                console.log(i)
            })
        </script>
    </fieldset>

</body>

</html>